---
title:  "Configuring the NFS Server"
excerpt: "소주제"
toc: true
toc_label: "페이지 주요 목차"
categories:
- 델피콤
tags:
- 개발팀
last_modified_at: 2019-08-21
---

## Configuring the NFS Server  
NFS 서버에서 내보내기를 구성하는 방법에는 두 가지가 있습니다.

* NFS 구성 파일, 즉 /etc/exports 를 수동으로 편집하십시오.
* 명령 줄을 통해, 즉 exportfs 명령을 사용합니다.

### **The /etc/exports Configuration File**  
/etc/exports 파일은 원격 호스트로 내보내는 파일 시스템을 제어하고 옵션을 지정합니다. 다음과 같은 구문 규칙을 따릅니다.

* 빈 줄은 무시됩니다.
* 주석을 추가하려면 해시 기호 (#)가있는 행을 시작하십시오.
* 긴 줄은 백 슬래시 (\)로 래핑 할 수 있습니다.
* 내 보낸 파일 시스템은 각각의 개별 행에 있어야합니다.
* 내 보낸 파일 시스템 뒤에있는 권한이 부여 된 호스트 목록은 공백 문자로 구분해야합니다.
* 각 호스트에 대한 옵션은 호스트 식별자 바로 뒤에 괄호 안에 있어야하며 호스트와 첫 번째 괄호를 구분하는 공백을 두지 않아야합니다.

내 보낸 파일 시스템의 각 항목에는 다음과 같은 구조가 있습니다.  
    
    export host(options)
    
위의 구조는 다음 변수를 사용합니다.  
**export**  
내보낼 디렉토리  
**host**  
내보내기가 공유되는 호스트 또는 네트워크  
**options**  
호스트에 사용할 옵션  

각 호스트에 대한 특정 옵션과 함께 여러 호스트를 지정할 수 있습니다. 그렇게하려면 공백으로 구분 된 목록과 같은 행에 각 호스트 이름과 그 다음에 괄호 안에 각각의 옵션을 나열하십시오.

    export host1(options1) host2(options2) host3(options3)

가장 간단한 형식의 /etc/exports 파일은 다음 예에서와 같이 내 보낸 디렉토리와 액세스가 허용 된 호스트 만 지정합니다.

    /exported/directory bob.example.com

여기서 bob.example.com은 /exported/directory/를 NFS 서버에서 마운트 할 수 있습니다. 이 예제에서는 옵션을 지정하지 않았으므로 NFS는 기본 설정을 사용합니다

기본 설정은 다음과 같습니다. 

**ro**  
내 보낸 파일 시스템은 읽기 전용입니다. 원격 호스트는 파일 시스템에서 공유되는 데이터를 변경할 수 없습니다. 호스트가 파일 시스템을 변경 (읽기 및 쓰기) 할 수있게하려면 rw 옵션을 지정하십시오.  
**sync**    
이전 요청에 의한 변경 사항이 디스크에 기록되기 전에 NFS 서버는 요청에 응답하지 않습니다. 대신 비동기 쓰기를 활성화하려면 async 옵션을 지정하십시오.  
**wdelay**    
NFS 서버는 다른 쓰기 요청이 임박한 것으로 의심 될 경우 디스크 쓰기를 지연시킵니다. 이는 별도의 쓰기 명령으로 디스크에 액세스해야하는 횟수를 줄여 쓰기 오버 헤드를 줄여 성능을 향상시킬 수 있습니다. 이 기능을 사용하지 않으려면 no_wdelay를 지정하십시오. no_wdelay는 기본 sync 옵션도 지정되어있는 경우에만 사용할 수 있습니다.  
**root_squash**  
이렇게하면 루트 사용자가 원격으로 (로컬이 아닌) 루트 권한을 갖는 것을 방지 할 수 있습니다. 대신 NFS 서버는 사용자 ID nfsnobody를 할당합니다. 이는 원격 루트 사용자의 권한을 가장 낮은 로컬 사용자에게 효과적으로 "과시 (squashes)"하여 원격 서버에 무단으로 기록 할 수 없게합니다. 루트 스쿼시를 사용하지 않으려면 no_root_squash를 지정하십시오.  

모든 원격 사용자 (루트 포함)를 스쿼시하려면 all_sqcduash를 사용하십시오. NFS 서버가 특정 호스트의 원격 사용자에게 할당해야하는 사용자 및 그룹 ID를 지정하려면 다음과 같이 각각 anonuid 및 anongid 옵션을 사용하십시오.  

    export host(anonuid=uid,anongid=gid)

여기에서 uid와 gid는 각각 사용자 ID 번호와 그룹 ID 번호입니다. anonuid 및 anongid 옵션을 사용하면 원격 NFS 사용자가 공유 할 수있는 특별한 사용자 및 그룹 계정을 만들 수 있습니다.

기본적으로 액세스 제어 목록 (ACL)은 Red Hat Enterprise Linux에서 NFS에 의해 지원됩니다. 이 기능을 사용하지 않으려면 파일 시스템을 내보낼 때 no_acl 옵션을 지정하십시오.

내 보낸 모든 파일 시스템의 각 기본값은 명시 적으로 대체 되어야합니다. 예를 들어, rw 옵션을 지정하지 않으면 내 보낸 파일 시스템이 읽기 전용으로 공유됩니다. 다음은 두 가지 기본 옵션을 무시하는 /etc/exports의 샘플 행입니다.

    /another/exported/directory 192.168.0.3(rw,async)

이 예에서 192.168.0.3은 /another/exported/directory/ read 및 write를 마운트 할 수 있으며 디스크에 대한 모든 쓰기는 비동기입니다. 옵션 내보내기에 대한 자세한 내용은 man exportfs를 참조하십시오.

기본값이 지정되지 않은 다른 옵션을 사용할 수 있습니다. 여기에는 하위 트리 검사를 비활성화하고 안전하지 않은 포트에서 액세스 할 수있게 해주는 기능, 안전하지 않은 파일 잠금을 허용하는 기능 (초기 NFS 클라이언트 구현에 필요)이 포함됩니다. 사용하지 않는 옵션에 대한 자세한 내용은 man exports를 참조하십시오.

### **The exportfs Command**  
NFS를 사용하여 원격 사용자에게 내보내는 모든 파일 시스템과 해당 파일 시스템의 액세스 수준은 /etc/exports 파일에 나열됩니다. nfs 서비스가 시작되면 /usr/sbin/exportfs 명령이 실행되어 이 파일을 읽은 다음 실제 마운트 프로세스에 대해 rpc.mountd (NFSv3 인 경우)로 제어를 전달한 다음 rpc.nfsd로 전달하여 파일 시스템을 원격으로 사용할 수 있도록합니다 사용자.

수동으로 실행하면 /usr/sbin/exportfs 명령을 사용하여 루트 사용자가 NFS 서비스를 다시 시작하지 않고 디렉토리를 선택적으로 내보내거나 반출 할 수 있습니다. 적절한 옵션이 주어지면 /usr/sbin/exportfs 명령은 내 보낸 파일 시스템을 /var/lib/nfs/xtab에 기록합니다. rpc.mountd는 파일 시스템에 대한 액세스 권한을 결정할 때 xtab 파일을 참조하므로 내 보낸 파일 시스템 목록의 변경 사항은 즉시 적용됩니다.

다음은 /usr/sbin/exportfs에서 일반적으로 사용되는 옵션 목록입니다.

**-r**  
/etc/libs/nfs/xtab에 새로운 내보내기 목록을 작성하여 /etc/exports에 나열된 모든 디렉토리를 내보내도록합니다. 이 옵션은 /etc/exports에 대한 변경 사항을 적용하여 내보내기 목록을 효과적으로 새로 고칩니다.

**-a**  
/usr/sbin/exportfs에 전달되는 다른 옵션에 따라 모든 디렉토리를 내보내거나 내 보내지 않습니다. 다른 옵션을 지정하지 않으면 /usr/sbin/exportfs는 /etc/exports에 지정된 모든 파일 시스템을 내 보냅니다

**-o file-systems**  
/etc/exports에 나열되지 않은 내보낼 디렉토리를 지정합니다. 파일 시스템을 내보낼 추가 파일 시스템으로 대체하십시오. 이 파일 시스템은 /etc/exports에 지정된 것과 같은 f 식으로 형식화되어야합니다. 이 옵션은 내 보낸 파일 시스템을 내보낼 파일 시스템 목록에 영구적으로 추가하기 전에 테스트하는 데 자주 사용됩니다.

**-i**  
/etc/exports를 무시합니다. 명령 행에서 제공된 옵션 만 내 보낸 파일 시스템을 정의하는 데 사용됩니다.

**-u**  
모든 공유 디렉토리의 압축을 풉니다. /usr/sbin/exportfs -ua 명령은 모든 NFS 데몬을 유지하면서 NFS 파일 공유를 일시 중단합니다. NFS 공유를 다시 사용하려면 exportfs -r을 사용하십시오.

**-v**  
exportfs 명령이 실행될 때 파일 시스템이 익스포트되거나 익스포트되지 않는 Verbose 조작이 보다 자세하게 표시됩니다.

exportfs 명령에 전달 된 옵션이 없으면 현재 내 보낸 파일 시스템의 목록을 표시합니다. exportfs 명령에 대한 자세한 내용은 man exportfs를 참조하십시오.



